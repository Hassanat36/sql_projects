# SQL Data Exploratory Project

## Table of Contents

1. [Introduction](#introduction)
2. [Dataset Structure](#dataset-structure)
3. [Installation](#installation)
5. [Usage](#usage)
6. [Data Sources](#data-sources)
7. [Tools](#tools)
8. [Data Cleaning and Preparation](#data-cleaning-and-preparation)
9. [Exploratory Data Analysis](#exploratory-data-analysis)
10. [Queries](#queries)
11. [Conclusions](#conclusions)
12. [Recommendations](#recommendations)

   ## Introduction
Welcome to My SQL Data Exploratory Project, an initiative designed to leverage the comprehensive dataset generated by Synthea,a powerful synthetic patient generator with a mission to produce high-quality, realistic, yet entirely fictional patient data. This dataset serves as the foundation for the data.world SQL tutorial exercises, offering a unique opportunity to explore and analyze synthetic patient data and associated health records.By using this synthetic dataset, I can delve into the complexities of healthcare data without compromising the privacy or confidentiality of real individuals.

## Dataset Structure
Dataset comprises of several tables, each representing a vital aspect of patient health and medical records. These tables include:

- All Prevalence: Overview of various health conditions and their prevalence.
- Allergies: Information on patient allergies.
- Care Plans: Details about healthcare plans designed for patients.
- Claim: Data related to insurance claims.
- Conditions: Information on various medical conditions.
- Encounter: Records of patient encounters with healthcare providers.
- Immunization: Details of administered immunizations.
- Medications: Information on prescribed medications.
- Observations: Recorded observations during patient interactions.
- Patient: Core information about synthetic patients.
- Procedure: Details of medical procedures undergone by synthetic patients.

## Installation

To run and interact with the SQL queries in this project, you'll need to have SQL Server Management Studio (SSMS) installed on your machine. Follow the steps below to install SSMS:

### Step 1: Download SSMS

1. Visit the official Microsoft website to download SQL Server Management Studio: [Download SSMS](https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms)

2. Choose the appropriate version of SSMS based on your operating system.

### Step 2: Install SSMS

#### For Windows:

1. Run the downloaded installer (SSMS-Setup-<version>-<language>.exe).

2. Follow the on-screen instructions in the Setup Wizard.

3. In the Feature Selection step, ensure that "Management Tools - Basic" or a more comprehensive option is selected.

4. Continue with the installation process, and complete the setup.

#### For macOS or Linux:

1. Download and install the Azure Data Studio, a cross-platform database tool that includes the SQL Server Query Editor. [Download Azure Data Studio](https://docs.microsoft.com/en-us/sql/azure-data-studio/download-azure-data-studio)

2. Follow the installation instructions for Azure Data Studio on the respective operating system.


## Usage

### Step 1: Connect to SQL Server

Once SSMS is installed, you'll need to connect to a SQL Server instance to run queries on the dataset.

1. Open SSMS.

2. In the "Connect to Server" window, enter the server name and authentication details.

3. Click "Connect" to establish a connection.

### Step 2: Open and Run Queries

1. Open a new query window in SSMS.

2. Copy and paste the SQL queries from this project into the query window.

3. Execute the queries to retrieve and analyze data.


## Data Sources

Dataset is from data.world SQL tutorial excercises.[click here](https://data.world/sparklesquad/sql-tutorial-exercise-data)


## Tools

- Excel for data cleaning
- Sql server for data exploration and queries

## Data Cleaning and Preparation

In the initial data preparation phase, I performed the following tasks
1. Data loading and inspection
2. Handling missing values
3. Data cleaning and formatting

   
## Exploratory Data Analysis

EDA involves exploring the Dataset to answer questions, such as:

### project questions

1. A query againt the allergies table 
that returns all the records.

2. Return all records from condition
where depscription diabetes or prediabetes

3. return unique description from procedures where reasondescription
is normal pregnancy and description not standard pregnancy test.

4. write a query to display patient,description,value and multiple the
value by 2.2 and rename it to [weight in Ibs] from observations table.
where description equals to Body weight.

5. A query againt the observations table. return patient,description,
value. divide the value by 2.5 and rename as Height in Inches
where description is Body Height.

6. write a query to select patient,description,reasondescription
from medications table
where reasondescription is not null.

7. Write a query joining the patients table to the medications table using the patient column. 
Use WHERE in your join condition.. 
Your results should contain the columns patient, marital, race, ethnicity, 
and gender from the patients table and description (renamed as medications),
and reasondescription (renamed as diagnosis) from the medications table.

8. Using the description column in the conditions table, 
write a query that returns all the data for patients who are diabetic (Diabetes) or predibetic (Prediabetes).

9. Using the description and reasondescription columns in the table procedures,
write a query that returns a list of all the descriptions for 
a normal pregnancy (Normal pregnancy) except a pregnancy test (Standard pregnancy test).

10. Using the patient, description and value columns in the observations table,
 write a query that returns all the patients expected to have between one and five quality years of life left. 
(Use the description column and “Quality adjusted life years”).

11. Write a query to show a list of all the asian female patients and the procedures they had.
(Use LEFT OUTER JOIN and join on the patient column from the patient and procedure tables.) 
Include the columns patients.patient, patients.race, patients.ethnicity, patients.gender,
 procedures.description (relabeled procedure), and procedures.r
easondescription (relabeled diagnosis) in your results.

12. Write a query that returns the patient column, the average of the value column relabeled as Avg BMI,
the count of the value column relabeled as Number of readings ,
and the maximum value of the value column filtered for values over 30 and label it as Max Obese BMI.
The query should be written against the observations_cleaned table and the results should all be for
records where the description is “Body Mass Index”. Group your results by the patient column.

13. Write a query that returns the patient column and a count of all the allergies the patient has from allergies table. 
Group your results by patient, and order them by the number of allergies from greatest to least.

14. Write a query that returns the description column, the maximum body height of all the patients, and the units from the observations table.

15. Write a query that returns the description and the number of patients who have an allergy to fish from the allergies table.

16. Write a query against the observations_cleaned table using the general CASE expression to return the patient and description columns, 
the average of the value column, and unit column along with a new column labeled BMI category. 
The results are only for the records where the description is Body Mass Index. The entries in
the BMI category column should be Underweight for values under 18.5, Healthy for values from 18.5 to 24.9, 
[Overweight for values of 25-29.9, and Obese for values over 30.

## Queries

Its includes the codes I worked with:

### project questions and Answers

- 1. A query againt the allergies table that returns all the records.
```
select * from MY_PROJECT.dbo.allergies
```

- 2. Return all records from condition where depscription diabetes or prediabetes
```
SELECT * FROM [dbo].[conditions]
WHERE [DESCRIPTION] = 'diabetes' OR [DESCRIPTION]= 'prediabetes';
```
- 3. return unique description from procedures where reasondescriptionis normal 
pregnancy and description not standard pregnancy test.
```
SELECT DISTINCT[DESCRIPTION],[REASONDESCRIPTION]
FROM [dbo].[procedures]
WHERE [REASONDESCRIPTION] = 'normal pregnancy' AND NOT [DESCRIPTION]  = 'standard pregnancy test'
```
- 4. write a query to display patient,description,value and multiple the
value by 2.2 and rename it to [weight in Ibs] from observations table.
where description equals to Body weight.
```
SELECT [PATIENT],[DESCRIPTION],([VALUE]*2.2)
AS 'Weight in Ibs'
FROM [dbo].[Observation_clean_new]
WHERE[DESCRIPTION] ='body Weight'
```

 - 5. A query againt the observations table. return patient,description,
value. divide the value by 2.5 and rename as Height in Inches
where description is Body Height.
```
SELECT [PATIENT],[DESCRIPTION],([VALUE]/2.5)
AS 'Height in Inches'
FROM [dbo].[observations]
WHERE [DESCRIPTION]='body Height'
```
- 6. write a query to select patient,description,reasondescription
from medications table
where reasondescription is not null.
```
SELECT [PATIENT],[DESCRIPTION],[REASONDESCRIPTION]
FROM [dbo].[medications]
WHERE [REASONDESCRIPTION] IS NOT NULL
```
- 7. Write a query joining the patients table to the medications table using the patient column. 
Use WHERE in your join condition.. 
Your results should contain the columns patient, marital, race, ethnicity, 
and gender from the patients table and description (renamed as medications),
and reasondescription (renamed as diagnosis) from the medications table.
```
SELECT [dbo].[patients].patient,[dbo].[patients].marital,[dbo].[patients].race,[dbo].[patients].ethnicity,[dbo].[patients].gender,
[DESCRIPTION] AS Medication,[REASONDESCRIPTION] as Dignosis
FROM [dbo].[patients]
INNER JOIN [dbo].[medications]
ON [dbo].[patients].patient=[dbo].[medications].PATIENT
```
- 8. Using the description column in the conditions table, 
write a query that returns all the data for patients who are diabetic (Diabetes) or predibetic (Prediabetes).
```
SELECT * FROM [dbo].[conditions]
WHERE [DESCRIPTION]='diabetes' OR [DESCRIPTION] ='prediabetes'
```
- 9. Using the description and reasondescription columns in the table procedures,
write a query that returns a list of all the descriptions for 
a normal pregnancy (Normal pregnancy) except a pregnancy test (Standard pregnancy test).
```
SELECT [DESCRIPTION],[REASONDESCRIPTION]
FROM [dbo].[procedures]
WHERE [REASONDESCRIPTION] = 'normal pregnancy' AND NOT [DESCRIPTION] ='Standard pregnancy test'
```
- 10. Using the patient, description and value columns in the observations table,
 write a query that returns all the patients expected to have between one and five quality years of life left. 
(Use the description column and “Quality adjusted life years”).
```
SELECT [PATIENT],[DESCRIPTION],[VALUE]
FROM [dbo].[observations]
WHERE [DESCRIPTION] = 'Quality adjusted life years'
```
- 11. Write a query to show a list of all the asian female patients and the procedures they had.
(Use LEFT OUTER JOIN and join on the patient column from the patient and procedure tables.) 
Include the columns patients.patient, patients.race, patients.ethnicity, patients.gender,
 procedures.description (relabeled procedure), and procedures.r
easondescription (relabeled diagnosis) in your results.
```
SELECT [dbo].[patients].[patient],[race],[ethnicity],[gender],[DESCRIPTION] AS Process,[REASONDESCRIPTION] AS Dignosis
FROM [dbo].[patients] 
LEFT OUTER JOIN [dbo].[procedures]
ON [dbo].[patients].patient=[dbo].[procedures].PATIENT
WHERE [race]='asian' AND [gender]='F'
```
- 12. Write a query that returns the patient column, the average of the value column relabeled as Avg BMI,
the count of the value column relabeled as Number of readings ,
and the maximum value of the value column filtered for values over 30 and label it as Max Obese BMI.
The query should be written against the observations_cleaned table and the results should all be for
records where the description is “Body Mass Index”. Group your results by the patient column.
```
SELECT [PATIENT], AVG([VALUE]) AS Average_BMI,COUNT([VALUE]) AS Number_of_Readings,MAX([VALUE]) AS Maximum_Obese_BMI
FROM [dbo].[Observation_clean_new] 
WHERE[DESCRIPTION] ='Body Mass Index'
GROUP BY [PATIENT]
HAVING MAX([VALUE])>30
```                           

- 13. Write a query that returns the patient column and a count of all the allergies the patient has from allergies table. 
Group your results by patient, and order them by the number of allergies from greatest to least.
```
SELECT [PATIENT],COUNT([CODE]) AS Number_of_Allergy
FROM [dbo].[allergies]
GROUP BY [PATIENT]
ORDER BY COUNT([CODE]) DESC 
```
- 14. Write a query that returns the description column, the maximum body height of all the patients, 
and the units from the observations table.
```
SELECT[PATIENT],[DESCRIPTION],[UNITS]
from [dbo].[Observation_clean_new]
where [DESCRIPTION]='Body Height' 
```

- 15. Write a query that returns the description and the number of patients who have an 
allergy to fish from the allergies table.
```
SELECT [PATIENT],[DESCRIPTION]
FROM [dbo].[allergies]
WHERE [DESCRIPTION]= 'allergy to fish'
```
- 16. Write a query against the observations_cleaned table using the general CASE expression to return the patient and description columns, 
the average of the value column, and unit column along with a new column labeled BMI category. 
The results are only for the records where the description is Body Mass Index. The entries in
the BMI category column should be Underweight for values under 18.5, Healthy for values from 18.5 to 24.9, 
[Overweight for values of 25-29.9, and Obese for values over 30.
```
SELECT [PATIENT],[DESCRIPTION],[VALUE],[UNITS],
CASE 
WHEN VALUE <18.5 THEN 'Underweight'
when VALUE <24.9 THEN 'Healthy'
when VALUE <29.9  THEN 'Overweight'
when VALUE >=30 THEN 'Obese' 
END
AS BMI_Category
FROM [dbo].[Observation_clean_new]
WHERE [DESCRIPTION]='Body Mass Index'
```

## Conclusions

In conclusion, the SQL Data Exploratory Project has offered a comprehensive exploration of synthetic patient data, shedding light on various aspects of healthcare. Through the use of SQL queries, I dissected and analyzed data related to patient conditions, allergies, medications, and more.The ability to work with realistic but synthetic data allows me to refine my SQL skills in a healthcare context, paving the way for more advanced data analytics and decision-making.


## Recommendations

1.Expand Analysis: Consider expanding the analysis to delve deeper into specific health conditions, patient demographics, or geographic variations within the synthetic dataset.
2.Educational Outreach: Extend the project's impact by creating educational materials, tutorials, or workshops to share insights gained and promote the use of SQL in healthcare analytics.
3.Community Collaboration: Encourage collaboration within the community to foster the sharing of queries, insights, and best practices in SQL data exploration.


